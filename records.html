<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>我的紀錄</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="bg-[#F7F9FB] pb-24">

<header class="bg-white border-b px-4 py-3 font-black text-lg">
  我的購課紀錄
</header>

<main class="max-w-4xl mx-auto p-4">
  <div id="record-list" class="space-y-4"></div>
</main>

<nav class="fixed bottom-0 left-0 right-0 bg-white border-t grid grid-cols-3 text-center">
  <a href="index.html" class="py-3"><i class="fas fa-compass"></i><div>探索</div></a>
  <a href="records.html" class="py-3 text-green-600 font-bold"><i class="fas fa-receipt"></i><div>紀錄</div></a>
  <a href="member.html" class="py-3"><i class="fas fa-user"></i><div>會員</div></a>
</nav>

<script>
const API_URL = 'https://aged-rice-2438.wetw-net3.workers.dev/';
const user = JSON.parse(localStorage.getItem('lineUser') || 'null');
if(!user) location.href = 'login.html';

async function loadRecords(){
  const res = await fetch(`${API_URL}?type=booking_list&lineUserId=${user.userId}`);
  const json = await res.json();
  const list = json.data || [];

  const box = document.getElementById('record-list');
  if(!list.length){
    box.innerHTML = '<div class="text-gray-400 text-center mt-10">尚無購課紀錄</div>';
    return;
  }

  box.innerHTML = list.map(b=>`
    <div class="bg-white rounded-xl p-4 shadow">
      <div class="font-black text-lg">${b.courseName}</div>
      <div class="text-sm text-gray-500">${b.courseDate} ${b.startTime}–${b.endTime}</div>
      <div class="mt-2 text-sm">報名對象：${b.attendeeName}（${b.attendeeRole}）</div>
      <div class="mt-1 text-sm">租用設備：${b.rentEquipment || '無'}</div>
      <div class="mt-2 font-bold text-green-600">$${b.price}</div>
    </div>
  `).join('');
}
loadRecords();
</script>
</body>
</html>
